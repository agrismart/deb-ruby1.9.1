From fd061353e3312b77b48eee7cf96cab8ca9b797ac Mon Sep 17 00:00:00 2001
From: usa <usa@b2dd03c8-39d4-4d8f-98ff-823fe69b080e>
Date: Wed, 6 Feb 2013 08:00:49 +0000
Subject: [PATCH] * lib/rdoc: Import RDoc 3.9.5.
 NOTE: This patch includes only main correctios.
Origin: upstream, https://github.com/ruby/ruby/commit/fd061353e3312b77b48eee7cf96cab8ca9b797ac
Bug: http://www.ruby-lang.org/ja/news/2013/02/06/rdoc-xss-cve-2013-0256/
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=699929

diff --git a/lib/rdoc/generator/template/darkfish/js/darkfish.js b/lib/rdoc/generator/template/darkfish/js/darkfish.js
index 84565c1..7a2f44c 100644
--- a/lib/rdoc/generator/template/darkfish/js/darkfish.js
+++ b/lib/rdoc/generator/template/darkfish/js/darkfish.js
@@ -73,13 +73,15 @@ function hookQuickSearch() {
 function highlightTarget( anchor ) {
 	console.debug( "Highlighting target '%s'.", anchor );
 
-	$("a[name=" + anchor + "]").each( function() {
-		if ( !$(this).parent().parent().hasClass('target-section') ) {
-			console.debug( "Wrapping the target-section" );
-			$('div.method-detail').unwrap( 'div.target-section' );
-			$(this).parent().wrap( '<div class="target-section"></div>' );
-		} else {
-			console.debug( "Already wrapped." );
+	$("a[name]").each( function() {
+		if ( $(this).attr("name") == anchor ) {
+			if ( !$(this).parent().parent().hasClass('target-section') ) {
+				console.debug( "Wrapping the target-section" );
+				$('div.method-detail').unwrap( 'div.target-section' );
+				$(this).parent().wrap( '<div class="target-section"></div>' );
+			} else {
+				console.debug( "Already wrapped." );
+			}
 		}
 	});
 };
