#! /bin/sh /usr/share/dpatch/dpatch-run
## 091207_test_dl_free_func.dpatch by akira yamada <akira@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: No description.

@DPATCH@
Index: b/test/dl/test_cptr.rb
===================================================================
--- a/test/dl/test_cptr.rb	2010-07-20 21:45:45.000000000 +0900
+++ b/test/dl/test_cptr.rb	2010-07-20 21:46:17.000000000 +0900
@@ -16,14 +16,14 @@
         include DL
         @libc = dlopen(LIBC_SO)
         @libm = dlopen(LIBM_SO)
-        free = CFunc.new(@libc['free'], TYPE_VOID, 'free')
+        free = CFunc.new(DL::RUBY_FREE, TYPE_VOID, 'free')
         ptr = CPtr.malloc(4)
         ptr.free = free
         free.ptr
         ptr.free.ptr
       End
 
-      free = CFunc.new(@libc['free'], TYPE_VOID, 'free')
+      free = CFunc.new(DL::RUBY_FREE, TYPE_VOID, 'free')
       ptr = CPtr.malloc(4)
       ptr.free = free
 
